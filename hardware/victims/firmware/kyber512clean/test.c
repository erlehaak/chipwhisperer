#include "kem.h"
#include "indcpa.h"
#include <stdio.h>

uint8_t sk[KYBER_SECRETKEYBYTES];
uint8_t pk[KYBER_PUBLICKEYBYTES];
uint8_t ss_a[KYBER_SSBYTES], ss_b[KYBER_SSBYTES];
uint8_t ct[KYBER_CIPHERTEXTBYTES];

uint8_t m_output[KYBER_INDCPA_MSGBYTES];

void printarray(uint8_t *array, size_t size){
    
    for(int i=0; i<size; i++) {
        printf("%hhu ", array[i]);
    }
    printf("\n\n");
}

int main(void)
{   
    /*
    PQCLEAN_KYBER512_CLEAN_crypto_kem_keypair(pk, sk);
    PQCLEAN_KYBER512_CLEAN_crypto_kem_enc(ct, ss_a, pk);
    PQCLEAN_KYBER512_CLEAN_crypto_kem_dec(ss_b, ct, sk);

    printf("Public key:\n");
    printarray(pk, sizeof(pk));
    printf("Secret key:\n");
    printarray(sk, sizeof(sk));
    printf("Shared secrets:\n");
    printarray(ss_a, sizeof(ss_a));
    printarray(ss_b, sizeof(ss_b));
    */

    uint8_t ct[] = {107, 148, 101, 37, 112, 224, 238, 29, 140, 28, 150, 123, 90, 160, 11, 27, 176, 11, 44, 155, 46, 85, 2, 85, 51, 175, 175, 245, 183, 174, 211, 54, 143, 98, 229, 134, 255, 142, 144, 139, 84, 158, 89, 146, 227, 78, 80, 67, 150, 149, 140, 232, 246, 255, 117, 121, 156, 2, 34, 12, 71, 72, 15, 178, 19, 69, 210, 39, 151, 42, 113, 167, 1, 20, 3, 19, 153, 208, 11, 42, 237, 218, 21, 8, 231, 158, 90, 32, 121, 81, 4, 175, 254, 49, 141, 12, 212, 98, 226, 5, 95, 222, 17, 130, 69, 95, 95, 29, 62, 180, 188, 166, 50, 43, 88, 4, 224, 18, 54, 93, 34, 235, 254, 162, 20, 37, 149, 123, 239, 170, 78, 136, 120, 60, 196, 48, 73, 138, 192, 183, 186, 223, 188, 2, 102, 75, 156, 136, 26, 101, 32, 73, 87, 209, 136, 59, 233, 35, 114, 16, 62, 137, 155, 243, 253, 139, 27, 202, 105, 16, 171, 163, 183, 48, 100, 135, 43, 220, 220, 228, 27, 109, 255, 135, 223, 238, 45, 74, 229, 163, 94, 216, 234, 114, 21, 119, 217, 245, 168, 147, 83, 89, 42, 41, 108, 78, 151, 44, 130, 38, 63, 213, 230, 229, 33, 250, 233, 145, 195, 155, 212, 114, 162, 169, 226, 18, 53, 5, 168, 1, 158, 249, 40, 130, 143, 215, 47, 55, 70, 49, 67, 73, 112, 31, 147, 154, 49, 157, 145, 17, 161, 235, 199, 134, 86, 79, 210, 206, 251, 209, 45, 6, 11, 77, 126, 5, 192, 26, 251, 205, 36, 205, 225, 251, 62, 138, 198, 224, 133, 75, 14, 94, 98, 131, 105, 136, 50, 241, 40, 226, 163, 7, 218, 237, 143, 24, 254, 138, 186, 14, 151, 92, 91, 45, 245, 10, 253, 240, 4, 175, 229, 228, 123, 12, 98, 169, 115, 194, 26, 77, 193, 216, 107, 218, 213, 209, 168, 45, 244, 191, 145, 213, 120, 16, 21, 44, 176, 121, 151, 129, 140, 250, 217, 110, 34, 66, 2, 158, 46, 72, 219, 194, 202, 23, 244, 70, 85, 200, 97, 80, 47, 243, 169, 32, 171, 238, 11, 252, 95, 171, 185, 131, 119, 83, 135, 43, 55, 0, 126, 198, 42, 79, 227, 236, 231, 208, 92, 146, 80, 206, 22, 234, 175, 149, 58, 19, 213, 230, 237, 90, 48, 6, 142, 90, 243, 225, 198, 122, 246, 242, 183, 52, 173, 17, 134, 133, 191, 239, 64, 249, 224, 53, 120, 237, 30, 172, 4, 22, 123, 64, 113, 66, 224, 50, 20, 97, 10, 61, 180, 48, 146, 63, 197, 53, 234, 10, 129, 74, 158, 248, 225, 71, 191, 2, 240, 137, 28, 45, 23, 56, 5, 156, 250, 228, 53, 153, 132, 220, 121, 54, 189, 108, 247, 238, 206, 187, 117, 8, 23, 47, 133, 80, 8, 57, 19, 69, 225, 209, 132, 224, 78, 68, 204, 221, 220, 39, 225, 223, 241, 4, 104, 50, 246, 214, 14, 146, 121, 182, 104, 86, 4, 10, 37, 202, 111, 211, 90, 129, 34, 68, 70, 38, 33, 165, 14, 197, 205, 43, 106, 229, 34, 75, 40, 16, 236, 34, 125, 138, 137, 227, 233, 23, 109, 83, 29, 221, 183, 240, 177, 110, 110, 85, 82, 135, 9, 234, 144, 206, 43, 107, 150, 35, 102, 188, 165, 181, 5, 46, 103, 107, 74, 4, 52, 105, 207, 151, 192, 33, 229, 72, 78, 23, 234, 171, 4, 49, 242, 230, 145, 208, 66, 168, 85, 145, 1, 174, 202, 170, 214, 146, 243, 86, 216, 206, 156, 19, 10, 121, 105, 241, 15, 15, 82, 139, 28, 21, 84, 58, 216, 31, 145, 68, 83, 19, 12, 164, 213, 130, 44, 165, 235, 248, 6, 48, 167, 211, 14, 243, 27, 14, 171, 229, 21, 86, 11, 153, 80, 162, 70, 96, 215, 198, 141, 227, 177, 163, 178, 160, 128, 220, 190, 62, 91, 8, 3, 125, 141, 153, 196, 152, 169, 158, 151, 19, 127, 186, 82, 141, 189, 139, 164, 56, 20, 91, 91, 185, 217, 218, 69, 88, 247, 240, 171, 29, 75, 127, 1, 118, 124, 158, 166, 240, 154, 82, 115, 166, 124, 149, 136, 28, 76, 17, 20, 215, 132, 25, 209, 236, 136, 120, 118, 203, 142, 221, 144, 155, 92, 119, 207, 233, 57, 112, 57, 214, 148, 101, 77, 125, 239, 163, 153, 48, 213, 16, 22, 94, 75, 160, 251, 82, 154, 10, 245, 241, 219, 218, 61, 231, 46, 206, 93, 163, 180, 17, 251, 77, 185, 75};
    uint8_t sk[] = {236, 70, 23, 249, 128, 71, 17, 219, 205, 155, 33, 7, 201, 51, 12, 72, 199, 136, 238, 9, 36, 62, 25, 154, 143, 88, 8, 170, 82, 95, 114, 116, 204, 85, 180, 46, 244, 129, 111, 125, 34, 207, 5, 24, 97, 49, 84, 205, 226, 210, 155, 147, 131, 1, 69, 42, 53, 168, 169, 66, 147, 245, 117, 115, 36, 169, 228, 27, 189, 117, 43, 61, 40, 245, 154, 206, 116, 81, 108, 92, 39, 207, 176, 41, 49, 51, 123, 150, 136, 27, 75, 54, 181, 142, 58, 97, 88, 171, 161, 228, 149, 112, 88, 25, 43, 62, 72, 93, 78, 49, 112, 7, 69, 79, 63, 68, 84, 111, 48, 202, 148, 25, 24, 218, 244, 116, 1, 28, 84, 8, 243, 30, 12, 1, 122, 69, 171, 67, 85, 230, 80, 24, 84, 175, 149, 83, 114, 147, 139, 113, 226, 132, 19, 109, 163, 0, 75, 49, 184, 60, 96, 61, 14, 57, 151, 96, 148, 116, 25, 134, 8, 139, 248, 46, 29, 9, 182, 11, 252, 147, 188, 59, 161, 220, 124, 170, 16, 108, 12, 23, 37, 197, 83, 214, 92, 226, 161, 77, 93, 83, 187, 54, 214, 15, 157, 17, 183, 196, 154, 120, 91, 90, 89, 121, 3, 58, 228, 75, 16, 79, 209, 207, 175, 209, 193, 225, 135, 35, 211, 37, 168, 119, 6, 73, 15, 52, 111, 161, 16, 200, 48, 139, 27, 81, 213, 14, 143, 196, 122, 255, 144, 196, 247, 155, 40, 130, 156, 111, 190, 103, 136, 59, 92, 193, 95, 6, 198, 187, 169, 83, 3, 122, 67, 19, 89, 10, 162, 177, 142, 79, 235, 203, 244, 67, 127, 91, 53, 205, 141, 148, 47, 212, 180, 109, 135, 8, 39, 48, 75, 204, 1, 28, 139, 51, 36, 201, 228, 129, 43, 115, 115, 58, 249, 201, 203, 203, 164, 18, 18, 81, 73, 135, 203, 10, 63, 133, 159, 254, 241, 194, 103, 124, 57, 57, 20, 123, 213, 86, 26, 127, 33, 95, 169, 38, 165, 198, 19, 202, 218, 153, 179, 243, 58, 82, 101, 198, 82, 209, 178, 89, 130, 179, 147, 220, 248, 124, 36, 35, 148, 162, 178, 99, 88, 161, 88, 205, 124, 71, 77, 40, 136, 3, 66, 51, 37, 10, 59, 220, 59, 4, 255, 44, 157, 133, 83, 181, 110, 101, 98, 217, 66, 72, 105, 81, 98, 214, 148, 52, 54, 74, 151, 32, 180, 92, 29, 88, 66, 179, 201, 24, 183, 50, 194, 26, 117, 66, 128, 201, 165, 16, 3, 106, 237, 4, 58, 90, 33, 44, 108, 232, 119, 210, 250, 202, 51, 144, 183, 227, 169, 54, 217, 187, 71, 22, 198, 154, 203, 101, 51, 240, 58, 165, 157, 185, 187, 117, 86, 29, 116, 83, 33, 150, 70, 184, 247, 130, 153, 145, 75, 5, 114, 168, 38, 77, 67, 74, 12, 182, 141, 86, 112, 94, 139, 241, 206, 23, 8, 93, 39, 161, 126, 168, 169, 84, 31, 120, 146, 2, 117, 2, 248, 185, 193, 239, 70, 156, 183, 8, 131, 242, 136, 44, 217, 162, 182, 138, 33, 145, 87, 135, 29, 53, 156, 125, 142, 218, 9, 148, 137, 150, 233, 246, 96, 115, 34, 174, 69, 166, 162, 80, 148, 86, 140, 19, 35, 172, 195, 168, 175, 98, 90, 107, 52, 51, 209, 167, 169, 140, 43, 102, 186, 76, 74, 190, 246, 203, 254, 226, 112, 143, 249, 90, 43, 12, 103, 19, 9, 199, 199, 2, 10, 37, 92, 111, 131, 195, 47, 172, 54, 164, 118, 179, 123, 249, 164, 189, 109, 245, 153, 90, 163, 39, 13, 194, 137, 114, 58, 182, 176, 226, 161, 77, 96, 204, 192, 112, 149, 242, 34, 159, 148, 170, 160, 178, 220, 168, 159, 54, 78, 55, 169, 199, 161, 145, 166, 104, 68, 104, 184, 99, 58, 198, 3, 57, 52, 183, 189, 161, 177, 61, 212, 68, 15, 162, 140, 154, 103, 228, 25, 110, 248, 148, 62, 124, 189, 238, 156, 152, 216, 52, 85, 70, 167, 8, 250, 150, 111, 133, 160, 207, 6, 121, 166, 191, 162, 43, 180, 117, 138, 61, 80, 182, 99, 25, 84, 157, 22, 139, 203, 122, 163, 42, 43, 140, 58, 177, 18, 3, 18, 5, 201, 108, 51, 214, 177, 65, 56, 150, 157, 62, 184, 26, 1, 55, 173, 56, 138, 147, 165, 252, 76, 47, 3, 124, 245, 165, 195, 93, 166, 199, 60, 246, 79, 126, 99, 179, 213, 230, 132, 173, 219, 35, 190, 5, 74, 85, 137, 70, 249, 183, 203, 119, 214, 179, 133, 214, 152, 251, 45, 80, 106, 97, 161, 39, 231, 26, 175, 209, 181, 249, 96, 52, 168, 164, 222, 4, 242, 144, 11, 208, 54, 234, 119, 184, 119, 11, 107, 165, 191, 181, 75, 41, 167, 48, 13, 173, 33, 199, 21, 168, 119, 101, 66, 127, 237, 119, 28, 224, 219, 136, 160, 36, 107, 228, 240, 150, 163, 210, 48, 55, 208, 137, 241, 56, 145, 11, 203, 126, 163, 22, 78, 115, 92, 120, 46, 59, 126, 9, 42, 80, 72, 139, 135, 117, 182, 64, 156, 32, 173, 189, 130, 4, 5, 161, 191, 222, 244, 24, 239, 101, 40, 214, 20, 176, 68, 160, 134, 59, 74, 181, 143, 17, 3, 122, 193, 205, 117, 65, 59, 1, 37, 44, 85, 102, 104, 125, 236, 201, 59, 70, 10, 150, 247, 185, 188, 37, 22, 243, 179, 34, 85, 59, 156, 67, 224, 201, 73, 17, 24, 194, 23, 124, 160, 76, 68, 102, 186, 46, 77, 37, 170, 181, 234, 164, 197, 121, 204, 35, 38, 101, 244, 120, 170, 53, 42, 20, 115, 193, 138, 80, 212, 171, 211, 146, 179, 78, 51, 22, 255, 18, 166, 86, 164, 66, 109, 224, 33, 122, 144, 130, 175, 248, 14, 193, 4, 27, 172, 88, 132, 7, 4, 10, 63, 245, 118, 32, 232, 181, 66, 4, 10, 13, 152, 141, 56, 35, 139, 131, 200, 76, 213, 21, 99, 54, 138, 185, 223, 49, 153, 160, 244, 34, 86, 10, 135, 161, 121, 144, 5, 234, 38, 36, 68, 98, 95, 0, 9, 90, 194, 184, 144, 161, 175, 52, 163, 142, 57, 124, 162, 6, 241, 163, 197, 149, 189, 230, 230, 51, 6, 230, 206, 240, 92, 63, 209, 124, 84, 24, 83, 133, 53, 44, 71, 245, 164, 86, 204, 152, 174, 224, 50, 84, 12, 213, 48, 92, 180, 155, 100, 90, 186, 109, 156, 151, 189, 106, 72, 31, 56, 188, 98, 209, 166, 223, 209, 182, 216, 184, 32, 78, 133, 26, 78, 203, 202, 3, 138, 163, 85, 50, 72, 233, 1, 39, 228, 16, 122, 183, 171, 27, 110, 249, 20, 157, 131, 134, 14, 17, 40, 168, 3, 9, 183, 183, 108, 120, 131, 89, 31, 92, 102, 33, 35, 94, 159, 2, 41, 23, 163, 163, 167, 211, 33, 97, 152, 97, 226, 86, 30, 130, 128, 10, 237, 51, 36, 218, 33, 23, 51, 115, 30, 60, 177, 207, 103, 170, 35, 174, 3, 170, 92, 27, 92, 189, 37, 99, 110, 25, 98, 137, 197, 39, 185, 178, 46, 225, 60, 75, 105, 193, 17, 138, 244, 183, 49, 83, 169, 127, 100, 78, 233, 55, 159, 8, 70, 17, 215, 57, 12, 160, 196, 130, 247, 17, 3, 227, 228, 132, 76, 165, 46, 192, 181, 191, 39, 120, 166, 111, 204, 149, 55, 10, 42, 134, 137, 159, 224, 215, 39, 13, 217, 9, 229, 76, 118, 91, 50, 155, 196, 113, 180, 212, 240, 95, 214, 35, 141, 49, 199, 151, 158, 72, 186, 128, 132, 43, 195, 66, 85, 246, 50, 199, 239, 183, 178, 113, 137, 107, 151, 49, 177, 173, 188, 19, 53, 182, 10, 172, 28, 190, 10, 0, 169, 176, 169, 49, 63, 184, 73, 192, 19, 30, 232, 220, 38, 222, 36, 175, 231, 169, 108, 183, 22, 180, 110, 10, 86, 205, 6, 26, 151, 215, 32, 146, 163, 128, 98, 145, 191, 87, 177, 9, 167, 119, 171, 44, 211, 98, 204, 151, 39, 201, 161, 44, 246, 197, 58, 236, 98, 19, 129, 24, 34, 209, 10, 114, 166, 96, 72, 114, 147, 84, 71, 147, 73, 155, 36, 15, 250, 137, 104, 35, 134, 101, 91, 36, 81, 169, 167, 12, 20, 76, 140, 239, 80, 191, 170, 165, 38, 48, 83, 36, 131, 172, 118, 39, 114, 197, 40, 135, 75, 247, 219, 62, 57, 196, 105, 134, 229, 136, 92, 81, 136, 21, 194, 98, 220, 247, 145, 82, 150, 7, 193, 136, 132, 219, 226, 95, 20, 181, 138, 154, 55, 195, 149, 152, 24, 0, 25, 30, 73, 213, 6, 208, 84, 113, 203, 241, 195, 60, 3, 58, 107, 59, 163, 174, 214, 110, 164, 38, 200, 244, 103, 35, 88, 86, 187, 223, 242, 25, 180, 132, 195, 0, 113, 173, 112, 50, 38, 243, 245, 3, 68, 53, 193, 27, 160, 104, 56, 185, 77, 33, 228, 14, 219, 242, 84, 69, 235, 176, 215, 2, 117, 174, 181, 89, 91, 138, 154, 11, 228, 47, 223, 160, 17, 172, 188, 170, 111, 59, 103, 155, 242, 60, 98, 246, 186, 142, 38, 55, 19, 236, 139, 2, 9, 49, 200, 24, 198, 238, 199, 165, 148, 217, 82, 120, 160, 150, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    PQCLEAN_KYBER512_CLEAN_indcpa_dec(m_output, ct, sk);
    printarray(m_output, KYBER_INDCPA_MSGBYTES);
    
    return 0;
}